jQuery(function(e){var t=e("meta[name=csrf-token]").attr("content"),i=e("meta[name=csrf-param]").attr("content");e.fn.extend({triggerAndReturn:function(t,i){var n=new e.Event(t);return this.trigger(n,i),n.result!==!1},callRemote:function(){var t=this,i=t.attr("method")||t.attr("data-method")||"GET",n=t.attr("action")||t.attr("href"),s=t.attr("data-type")||"script";if(void 0===n)throw"No URL specified for remote call (action or href must be present).";if(t.triggerAndReturn("ajax:before")){var r=t.is("form")?t.serializeArray():[];e.ajax({url:n,data:r,dataType:s,type:i.toUpperCase(),beforeSend:function(e){t.trigger("ajax:loading",e)},success:function(e,i,n){t.trigger("ajax:success",[e,i,n])},complete:function(e){t.trigger("ajax:complete",e)},error:function(e,i,n){t.trigger("ajax:failure",[e,i,n])}})}t.trigger("ajax:after")}}),e("a[data-confirm],input[data-confirm]").live("click",function(){var t=e(this);return t.triggerAndReturn("confirm")&&!confirm(t.attr("data-confirm"))?!1:void 0}),e("form[data-remote]").live("submit",function(t){e(this).callRemote(),t.preventDefault()}),e("a[data-remote],input[data-remote]").live("click",function(t){e(this).callRemote(),t.preventDefault()}),e("a[data-method]:not([data-remote])").live("click",function(n){var s=e(this),r=s.attr("href"),a=s.attr("data-method"),o=e('<form method="post" action="'+r+'"></form>'),l='<input name="_method" value="'+a+'" type="hidden" />';null!=i&&null!=t&&(l+='<input name="'+i+'" value="'+t+'" type="hidden" />'),o.hide().append(l).appendTo("body"),n.preventDefault(),o.submit()});var n="input[data-disable-with]",s="form[data-remote]:has("+n+")",r="form:not([data-remote]):has("+n+")",a=function(){e(this).find(n).each(function(){var t=e(this);t.data("enable-with",t.val()).attr("value",t.attr("data-disable-with")).attr("disabled","disabled")})};e(s).live("ajax:before",a),e(r).live("submit",a),e(s).live("ajax:complete",function(){e(this).find(n).each(function(){var t=e(this);t.removeAttr("disabled").val(t.data("enable-with"))})})});