/**
 * jquery.Jcrop.min.js v0.9.12 (build:20130202)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2013 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
!function(e){e.Jcrop=function(t,n){function r(e){return Math.round(e)+"px"}function i(e){return F.baseClass+"-"+e}function o(){return e.fx.step.hasOwnProperty("backgroundColor")}function a(t){var n=e(t).offset();return[n.left,n.top]}function s(e){return[e.pageX-H[0],e.pageY-H[1]]}function u(t){"object"!=typeof t&&(t={}),F=e.extend(F,t),e.each(["onChange","onSelect","onRelease","onDblClick"],function(e,t){"function"!=typeof F[t]&&(F[t]=function(){})})}function l(e,t,n){if(H=a(z),ht.setCursor("move"===e?e:e+"-resize"),"move"===e)return ht.activateHandlers(f(t),m,n);var r=ft.getFixed(),i=d(e),o=ft.getCorner(d(i));ft.setPressed(ft.getCorner(i)),ft.setCurrent(o),ht.activateHandlers(c(e,r),m,n)}function c(e,t){return function(n){if(F.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}ft.setCurrent(n),pt.update()}}function f(e){var t=e;return gt.watchKeys(),function(e){ft.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,pt.update()}}function d(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function p(e){return function(t){return F.disabled?!1:"move"!==e||F.allowMove?(H=a(z),rt=!0,l(e,s(t)),t.stopPropagation(),t.preventDefault(),!1):!1}}function h(e,t,n){var r=e.width(),i=e.height();r>t&&t>0&&(r=t,i=t/e.width()*e.height()),i>n&&n>0&&(i=n,r=n/e.height()*e.width()),tt=e.width()/r,nt=e.height()/i,e.width(r).height(i)}function g(e){return{x:e.x*tt,y:e.y*nt,x2:e.x2*tt,y2:e.y2*nt,w:e.w*tt,h:e.h*nt}}function m(){var e=ft.getFixed();e.w>F.minSelect[0]&&e.h>F.minSelect[1]?(pt.enableHandles(),pt.done()):pt.release(),ht.setCursor(F.allowSelect?"crosshair":"default")}function v(e){if(F.disabled)return!1;if(!F.allowSelect)return!1;rt=!0,H=a(z),pt.disableHandles(),ht.setCursor("crosshair");var t=s(e);return ft.setPressed(t),pt.update(),ht.activateHandlers(y,m,"touch"===e.type.substring(0,5)),gt.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function y(e){ft.setCurrent(e),pt.update()}function b(){var t=e("<div></div>").addClass(i("tracker"));return _&&t.css({opacity:0,backgroundColor:"white"}),t}function $(e){U.removeClass().addClass(i("holder")).addClass(e)}function x(e,t){function n(){window.setTimeout(y,f)}var r=e[0]/tt,i=e[1]/nt,o=e[2]/tt,a=e[3]/nt;if(!it){var s=ft.flipCoords(r,i,o,a),u=ft.getFixed(),l=[u.x,u.y,u.x2,u.y2],c=l,f=F.animationDelay,d=s[0]-l[0],p=s[1]-l[1],h=s[2]-l[2],g=s[3]-l[3],m=0,v=F.swingSpeed;r=c[0],i=c[1],o=c[2],a=c[3],pt.animMode(!0);var y=function(){return function(){m+=(100-m)/v,c[0]=Math.round(r+m/100*d),c[1]=Math.round(i+m/100*p),c[2]=Math.round(o+m/100*h),c[3]=Math.round(a+m/100*g),m>=99.8&&(m=100),100>m?(C(c),n()):(pt.done(),pt.animMode(!1),"function"==typeof t&&t.call(mt))}}();n()}}function w(e){C([e[0]/tt,e[1]/nt,e[2]/tt,e[3]/nt]),F.onSelect.call(mt,g(ft.getFixed())),pt.enableHandles()}function C(e){ft.setPressed([e[0],e[1]]),ft.setCurrent([e[2],e[3]]),pt.update()}function k(){return g(ft.getFixed())}function S(){return ft.getFixed()}function T(e){u(e),O()}function E(){F.disabled=!0,pt.disableHandles(),pt.setCursor("default"),ht.setCursor("default")}function N(){F.disabled=!1,O()}function A(){pt.done(),ht.activateHandlers(null,null)}function j(){U.remove(),R.show(),R.css("visibility","visible"),e(t).removeData("Jcrop")}function D(e,t){pt.release(),E();var n=new Image;n.onload=function(){var r=n.width,i=n.height,o=F.boxWidth,a=F.boxHeight;z.width(r).height(i),z.attr("src",e),X.attr("src",e),h(z,o,a),V=z.width(),W=z.height(),X.width(V).height(W),st.width(V+2*at).height(W+2*at),U.width(V).height(W),dt.resize(V,W),N(),"function"==typeof t&&t.call(mt)},n.src=e}function M(e,t,n){var r=t||F.bgColor;F.bgFade&&o()&&F.fadeTime&&!n?e.animate({backgroundColor:r},{queue:!1,duration:F.fadeTime}):e.css("backgroundColor",r)}function O(e){F.allowResize?e?pt.enableOnly():pt.enableHandles():pt.disableHandles(),ht.setCursor(F.allowSelect?"crosshair":"default"),pt.setCursor(F.allowMove?"move":"default"),F.hasOwnProperty("trueSize")&&(tt=F.trueSize[0]/V,nt=F.trueSize[1]/W),F.hasOwnProperty("setSelect")&&(w(F.setSelect),pt.done(),delete F.setSelect),dt.refresh(),F.bgColor!=ut&&(M(F.shade?dt.getShades():U,F.shade?F.shadeColor||F.bgColor:F.bgColor),ut=F.bgColor),lt!=F.bgOpacity&&(lt=F.bgOpacity,F.shade?dt.refresh():pt.setBgOpacity(lt)),K=F.maxSize[0]||0,Q=F.maxSize[1]||0,Z=F.minSize[0]||0,et=F.minSize[1]||0,F.hasOwnProperty("outerImage")&&(z.attr("src",F.outerImage),delete F.outerImage),pt.refresh()}var H,F=e.extend({},e.Jcrop.defaults),L=navigator.userAgent.toLowerCase(),_=/msie/.test(L),q=/msie [1-6]\./.test(L);"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof n&&(n={}),u(n);var P={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},R=e(t),I=!0;if("IMG"==t.tagName){if(0!=R[0].width&&0!=R[0].height)R.width(R[0].width),R.height(R[0].height);else{var B=new Image;B.src=R[0].src,R.width(B.width),R.height(B.height)}var z=R.clone().removeAttr("id").css(P).show();z.width(R.width()),z.height(R.height()),R.after(z).hide()}else z=R.css(P).show(),I=!1,null===F.shade&&(F.shade=!0);h(z,F.boxWidth,F.boxHeight);var V=z.width(),W=z.height(),U=e("<div />").width(V).height(W).addClass(i("holder")).css({position:"relative",backgroundColor:F.bgColor}).insertAfter(R).append(z);F.addClass&&U.addClass(F.addClass);var X=e("<div />"),J=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),G=e("<div />").width("100%").height("100%").css("zIndex",320),Y=e("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var e=ft.getFixed();F.onDblClick.call(mt,e)}).insertBefore(z).append(J,G);I&&(X=e("<img />").attr("src",z.attr("src")).css(P).width(V).height(W),J.append(X)),q&&Y.css({overflowY:"hidden"});var K,Q,Z,et,tt,nt,rt,it,ot,at=F.boundary,st=b().width(V+2*at).height(W+2*at).css({position:"absolute",top:r(-at),left:r(-at),zIndex:290}).mousedown(v),ut=F.bgColor,lt=F.bgOpacity;H=a(z);var ct=function(){function e(){var e,t={},n=["touchstart","touchmove","touchend"],r=document.createElement("div");try{for(e=0;e<n.length;e++){var i=n[e];i="on"+i;var o=i in r;o||(r.setAttribute(i,"return;"),o="function"==typeof r[i]),t[n[e]]=o}return t.touchstart&&t.touchend&&t.touchmove}catch(a){return!1}}function t(){return F.touchSupport===!0||F.touchSupport===!1?F.touchSupport:e()}return{createDragger:function(e){return function(t){return F.disabled?!1:"move"!==e||F.allowMove?(H=a(z),rt=!0,l(e,s(ct.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1):!1}},newSelection:function(e){return v(ct.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:t()}}(),ft=function(){function e(e){e=a(e),h=d=e[0],g=p=e[1]}function t(e){e=a(e),c=e[0]-h,f=e[1]-g,h=e[0],g=e[1]}function n(){return[c,f]}function r(e){var t=e[0],n=e[1];0>d+t&&(t-=t+d),0>p+n&&(n-=n+p),g+n>W&&(n+=W-(g+n)),h+t>V&&(t+=V-(h+t)),d+=t,h+=t,p+=n,g+=n}function i(e){var t=o();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function o(){if(!F.aspectRatio)return u();var e,t,n,r,i=F.aspectRatio,o=F.minSize[0]/tt,a=F.maxSize[0]/tt,c=F.maxSize[1]/nt,f=h-d,m=g-p,v=Math.abs(f),y=Math.abs(m),b=v/y;return 0===a&&(a=10*V),0===c&&(c=10*W),i>b?(t=g,n=y*i,e=0>f?d-n:n+d,0>e?(e=0,r=Math.abs((e-d)/i),t=0>m?p-r:r+p):e>V&&(e=V,r=Math.abs((e-d)/i),t=0>m?p-r:r+p)):(e=h,r=v/i,t=0>m?p-r:p+r,0>t?(t=0,n=Math.abs((t-p)*i),e=0>f?d-n:n+d):t>W&&(t=W,n=Math.abs(t-p)*i,e=0>f?d-n:n+d)),e>d?(o>e-d?e=d+o:e-d>a&&(e=d+a),t=t>p?p+(e-d)/i:p-(e-d)/i):d>e&&(o>d-e?e=d-o:d-e>a&&(e=d-a),t=t>p?p+(d-e)/i:p-(d-e)/i),0>e?(d-=e,e=0):e>V&&(d-=e-V,e=V),0>t?(p-=t,t=0):t>W&&(p-=t-W,t=W),l(s(d,p,e,t))}function a(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>V&&(e[0]=V),e[1]>W&&(e[1]=W),[Math.round(e[0]),Math.round(e[1])]}function s(e,t,n,r){var i=e,o=n,a=t,s=r;return e>n&&(i=n,o=e),t>r&&(a=r,s=t),[i,a,o,s]}function u(){var e,t=h-d,n=g-p;return K&&Math.abs(t)>K&&(h=t>0?d+K:d-K),Q&&Math.abs(n)>Q&&(g=n>0?p+Q:p-Q),et/nt&&Math.abs(n)<et/nt&&(g=n>0?p+et/nt:p-et/nt),Z/tt&&Math.abs(t)<Z/tt&&(h=t>0?d+Z/tt:d-Z/tt),0>d&&(h-=d,d-=d),0>p&&(g-=p,p-=p),0>h&&(d-=h,h-=h),0>g&&(p-=g,g-=g),h>V&&(e=h-V,d-=e,h-=e),g>W&&(e=g-W,p-=e,g-=e),d>V&&(e=d-W,g-=e,p-=e),p>W&&(e=p-W,g-=e,p-=e),l(s(d,p,h,g))}function l(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var c,f,d=0,p=0,h=0,g=0;return{flipCoords:s,setPressed:e,setCurrent:t,getOffset:n,moveOffset:r,getCorner:i,getFixed:o}}(),dt=function(){function t(e,t){h.left.css({height:r(t)}),h.right.css({height:r(t)})}function n(){return i(ft.getFixed())}function i(e){h.top.css({left:r(e.x),width:r(e.w),height:r(e.y)}),h.bottom.css({top:r(e.y2),left:r(e.x),width:r(e.w),height:r(W-e.y2)}),h.right.css({left:r(e.x2),width:r(V-e.x2)}),h.left.css({width:r(e.x)})}function o(){return e("<div />").css({position:"absolute",backgroundColor:F.shadeColor||F.bgColor}).appendTo(p)}function a(){d||(d=!0,p.insertBefore(z),n(),pt.setBgOpacity(1,0,1),X.hide(),s(F.shadeColor||F.bgColor,1),pt.isAwake()?l(F.bgOpacity,1):l(1,1))}function s(e,t){M(f(),e,t)}function u(){d&&(p.remove(),X.show(),d=!1,pt.isAwake()?pt.setBgOpacity(F.bgOpacity,1,1):(pt.setBgOpacity(1,1,1),pt.disableHandles()),M(U,0,1))}function l(e,t){d&&(F.bgFade&&!t?p.animate({opacity:1-e},{queue:!1,duration:F.fadeTime}):p.css({opacity:1-e}))}function c(){F.shade?a():u(),pt.isAwake()&&l(F.bgOpacity)}function f(){return p.children()}var d=!1,p=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),h={top:o(),left:o().height(W),right:o().height(W),bottom:o()};return{update:n,updateRaw:i,getShades:f,setBgColor:s,enable:a,disable:u,resize:t,refresh:c,opacity:l}}(),pt=function(){function t(t){var n=e("<div />").css({position:"absolute",opacity:F.borderOpacity}).addClass(i(t));return J.append(n),n}function n(t,n){var r=e("<div />").mousedown(p(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n}).addClass("ord-"+t);return ct.support&&r.bind("touchstart.jcrop",ct.createDragger(t)),G.append(r),r}function o(e){var t=F.handleSize,r=n(e,E++).css({opacity:F.handleOpacity}).addClass(i("handle"));return t&&r.width(t).height(t),r}function a(e){return n(e,E++).addClass("jcrop-dragbar")}function s(e){var t;for(t=0;t<e.length;t++)j[e[t]]=a(e[t])}function u(e){var n,r;for(r=0;r<e.length;r++){switch(e[r]){case"n":n="hline";break;case"s":n="hline bottom";break;case"e":n="vline right";break;case"w":n="vline"}N[e[r]]=t(n)}}function l(e){var t;for(t=0;t<e.length;t++)A[e[t]]=o(e[t])}function c(e,t){F.shade||X.css({top:r(-t),left:r(-e)}),Y.css({top:r(t),left:r(e)})}function f(e,t){Y.width(Math.round(e)).height(Math.round(t))}function d(){var e=ft.getFixed();ft.setPressed([e.x,e.y]),ft.setCurrent([e.x2,e.y2]),h()}function h(e){return T?m(e):void 0}function m(e){var t=ft.getFixed();f(t.w,t.h),c(t.x,t.y),F.shade&&dt.updateRaw(t),T||y(),e?F.onSelect.call(mt,g(t)):F.onChange.call(mt,g(t))}function v(e,t,n){(T||t)&&(F.bgFade&&!n?z.animate({opacity:e},{queue:!1,duration:F.fadeTime}):z.css("opacity",e))}function y(){Y.show(),F.shade?dt.opacity(lt):v(lt,!0),T=!0}function $(){C(),Y.hide(),F.shade?dt.opacity(1):v(1),T=!1,F.onRelease.call(mt)}function x(){D&&G.show()}function w(){return D=!0,F.allowResize?(G.show(),!0):void 0}function C(){D=!1,G.hide()}function k(e){e?(it=!0,C()):(it=!1,w())}function S(){k(!1),d()}var T,E=370,N={},A={},j={},D=!1;F.dragEdges&&e.isArray(F.createDragbars)&&s(F.createDragbars),e.isArray(F.createHandles)&&l(F.createHandles),F.drawBorders&&e.isArray(F.createBorders)&&u(F.createBorders),e(document).bind("touchstart.jcrop-ios",function(t){e(t.currentTarget).hasClass("jcrop-tracker")&&t.stopPropagation()});var M=b().mousedown(p("move")).css({cursor:"move",position:"absolute",zIndex:360});return ct.support&&M.bind("touchstart.jcrop",ct.createDragger("move")),J.append(M),C(),{updateVisible:h,update:m,release:$,refresh:d,isAwake:function(){return T},setCursor:function(e){M.css("cursor",e)},enableHandles:w,enableOnly:function(){D=!0},showHandles:x,disableHandles:C,animMode:k,setBgOpacity:v,done:S}}(),ht=function(){function t(t){st.css({zIndex:450}),t?e(document).bind("touchmove.jcrop",a).bind("touchend.jcrop",u):d&&e(document).bind("mousemove.jcrop",r).bind("mouseup.jcrop",i)}function n(){st.css({zIndex:290}),e(document).unbind(".jcrop")}function r(e){return c(s(e)),!1}function i(e){return e.preventDefault(),e.stopPropagation(),rt&&(rt=!1,f(s(e)),pt.isAwake()&&F.onSelect.call(mt,g(ft.getFixed())),n(),c=function(){},f=function(){}),!1}function o(e,n,r){return rt=!0,c=e,f=n,t(r),!1}function a(e){return c(s(ct.cfilter(e))),!1}function u(e){return i(ct.cfilter(e))}function l(e){st.css("cursor",e)}var c=function(){},f=function(){},d=F.trackDocument;return d||st.mousemove(r).mouseup(i).mouseout(i),z.before(st),{activateHandlers:o,setCursor:l}}(),gt=function(){function t(){F.keySupport&&(o.show(),o.focus())}function n(){o.hide()}function r(e,t,n){F.allowMove&&(ft.moveOffset([t,n]),pt.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}function i(e){if(e.ctrlKey||e.metaKey)return!0;ot=e.shiftKey?!0:!1;var t=ot?10:1;switch(e.keyCode){case 37:r(e,-t,0);break;case 39:r(e,t,0);break;case 38:r(e,0,-t);break;case 40:r(e,0,t);break;case 27:F.allowSelect&&pt.release();break;case 9:return!0}return!1}var o=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),a=e("<div />").css({position:"absolute",overflow:"hidden"}).append(o);return F.keySupport&&(o.keydown(i).blur(n),q||!F.fixedSupport?(o.css({position:"absolute",left:"-20px"}),a.append(o).insertBefore(z)):o.insertBefore(z)),{watchKeys:t}}();ct.support&&st.bind("touchstart.jcrop",ct.newSelection),G.hide(),O(!0);var mt={setImage:D,animateTo:x,setSelect:w,setOptions:T,tellSelect:k,tellScaled:S,setClass:$,disable:E,enable:N,cancel:A,release:pt.release,destroy:j,focus:gt.watchKeys,getBounds:function(){return[V*tt,W*nt]},getWidgetSize:function(){return[V,W]},getScaleFactor:function(){return[tt,nt]},getOptions:function(){return F},ui:{holder:U,selection:Y}};return _&&U.bind("selectstart",function(){return!1}),R.data("Jcrop",mt),mt},e.fn.Jcrop=function(t,n){var r;return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else"IMG"==this.tagName?e.Jcrop.Loader(this,function(){e(this).css({display:"block",visibility:"hidden"}),r=e.Jcrop(this,t),e.isFunction(n)&&n.call(r)}):(e(this).css({display:"block",visibility:"hidden"}),r=e.Jcrop(this,t),e.isFunction(n)&&n.call(r))}),this},e.Jcrop.Loader=function(t,n,r){function i(){a.complete?(o.unbind(".jcloader"),e.isFunction(n)&&n.call(a)):window.setTimeout(i,50)}var o=e(t),a=o[0];o.bind("load.jcloader",i).bind("error.jcloader",function(){o.unbind(".jcloader"),e.isFunction(r)&&r.call(a)}),a.complete&&e.isFunction(n)&&(o.unbind(".jcloader"),n.call(a))},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery);